{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios'; \n\nconst API_KEY = '46087000-8dffe905d5bdd270a8d626623';  \nconst BASE_URL = 'https://pixabay.com/api/'; \nexport const PER_PAGE = 15; \n\nexport async function fetchImages(query, page = 1) {\n  const params = new URLSearchParams({\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: PER_PAGE,\n    page: page,\n  });\n\n  const response = await axios.get(`${BASE_URL}?key=${API_KEY}&${params}`);\n  const {\n    data: { hits, totalHits },\n  } = response;\n  return { hits, totalHits };\n}\n\n\n\n// try {\n//     const response = await axios.get(BASE_URL, {\n//     params: {\n//         key: API_KEY,\n//         q: query,\n//         image_type: 'photo',\n//         orientation: 'horizontal',\n//         safesearch: true,\n//         page: page,\n//         per_page: 15,\n//     },\n//     });\n//     return response.data;\n// } catch (error) {\n//     throw new Error(\"Images not found\");\n// }","\nexport function createMarkup(data) {\n    return data.map(({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n    }) => {\n        return `<li class=\"gallery-list\">\n                    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                        <img class=\"img\" src=\"${webformatURL}\" \n                        alt=\"${tags}\" \n                        title=\"${tags}\" />\n                    </a>\n                    <ul class=\"data-list\">\n                        <li class=\"data-item\">\n                            <p class=\"data-name\">Likes</p>\n                            <p class=\"data-result\">${likes}</p>\n                        </li>\n                        <li class=\"data-item\">\n                            <p class=\"data-name\">Views</p>\n                            <p class=\"data-result\">${views}</p>\n                        </li>\n                        <li class=\"data-item\">\n                            <p class=\"data-name\">Comments</p>\n                            <p class=\"data-result\">${comments}</p>\n                        </li>\n                        <li class=\"data-item\">\n                            <p class=\"data-name\">Downloads</p>\n                            <p class=\"data-result\">${downloads}</p>\n                        </li>\n                    </ul> \n        </li>`;\n    }).join(\"\");\n    \n};","\nimport SimpleLightbox from \"simplelightbox\";  \nimport \"simplelightbox/dist/simple-lightbox.min.css\";  \n\nimport \"izitoast/dist/css/iziToast.min.css\";  \nimport iziToast from \"izitoast\";  \n\nimport { fetchImages, PER_PAGE } from \"./js/pixabay-api\";  \nimport { createMarkup } from \"./js/render-functions\";  \n  \n\nconst formEl = document.querySelector('.form');  \nconst galleryEl = document.querySelector('.gallery');  \nconst loaderEl = document.querySelector('.loader');  \nconst btnMoreEl = document.querySelector('.btn-more');  \n\nlet lightbox = new SimpleLightbox('.gallery a', {});\n\n\nformEl.addEventListener('submit', handleSubmit);\nbtnMoreEl.addEventListener('click', onLoadMoreClick);\n\nlet currentPage = 1;\nlet query = '';\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  \n  const foundValue = event.target.elements.query.value.trim();\n  \n  query = foundValue;\n  currentPage = 1;\n  galleryEl.innerHTML = '';\n  btnMoreEl.classList.remove('is-hidden');\n\n  if (!foundValue) {\n    iziToast.error({\n      message: 'Please enter a search word',\n      position: 'topRight',\n    });\n    btnMoreEl.classList.add('is-hidden');\n    return;\n  }\n  loaderEl.classList.add('is-hidden');\n\n  try {\n    const { hits } = await fetchImages(query, currentPage);\n    if (!hits || hits.length === 0) {\n      iziToast.error({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    hits.length < PER_PAGE\n      ? btnMoreEl.classList.remove('is-hidden')\n      : btnMoreEl.classList.add('is-hidden');\n    \n    const markup = createMarkup(hits);\n    galleryEl.insertAdjacentHTML(\"beforeend\", markup);\n\n    lightbox.refresh();\n  } catch (error) {\n    console.log(error.message);\n  } finally {\n    loaderEl.classList.remove('is-visible');\n    formEl.reset();\n  }\n};\n\nasync function onLoadMoreClick() {\n  currentPage += 1;\n\n  try {\n    loaderEl.classList.add('is-hidden');\n    btnMoreEl.classList.remove('is-hidden');\n\n    const { hits, totalHits } = await fetchImages(query, currentPage);\n    const markup = createMarkup(hits);\n    galleryEl.insertAdjacentHTML(\"beforeend\", markup);\n\n    lightbox.refresh();\n\n    handleScrollView();\n\n    if (currentPage > Math.ceil(totalHits / PER_PAGE) - 1) {\n      btnMoreEl.classList.remove('is-hidden');\n      iziToast.error({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      return;\n    }\n    btnMoreEl.classList.add('is-hidden');\n  } catch (error) {\n    console.log(error.message);\n  } finally {\n    loaderEl.classList.remove('is-hidden');\n  }\n};\n\nfunction handleScrollView() {\n  const imageHeight = galleryEl.querySelector('li');\n  const articleHeight = imageHeight.getBoundingClientRect().height;\n  const scrollHeight = articleHeight * 2 + 140;\n\n  window.scrollBy({\n    top: scrollHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\n"],"names":["API_KEY","BASE_URL","PER_PAGE","fetchImages","query","page","params","response","axios","hits","totalHits","createMarkup","data","webformatURL","largeImageURL","tags","likes","views","comments","downloads","formEl","galleryEl","loaderEl","btnMoreEl","lightbox","SimpleLightbox","handleSubmit","onLoadMoreClick","currentPage","event","foundValue","iziToast","markup","error","handleScrollView","scrollHeight"],"mappings":"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"}